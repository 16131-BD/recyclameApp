<div class="app-layout">
  <!-- Sidebar -->
  <aside class="sidebar" [class.open]="sidebarOpen">
    <div class="sidebar-header">
      <div class="sidebar-brand">
        <div class="logo">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5"/>
            <path d="M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12"/>
            <path d="m14 16-3 3 3 3"/>
            <path d="M8.293 13.596 4.875 7.33a1.783 1.783 0 0 1 .013-1.782A1.83 1.83 0 0 1 6.46 4.64l8.08.004"/>
            <path d="m10 8 3-3-3-3"/>
          </svg>
        </div>
        <div>
          <h2>RecyclameApp</h2>
          <span>Panel Administrativo</span>
        </div>
      </div>
    </div>

    <nav class="sidebar-nav">
      <!-- Principal -->
      <div class="nav-section">
        <div class="nav-section-title">Principal</div>
        <div class="nav-item" *ngFor="let item of menuPrincipal">
          <a 
            class="nav-link" 
            [routerLink]="[item.uri]"
            [class.active]="item.selected"
            (click)="selectMenuItem(item)"
          >
            <span class="icon" [innerHTML]="item.iconSvg"></span>
            <span>{{ item.name }}</span>
            @if (item.badge) {
              <span class="badge">{{ item.badge }}</span>
            }
          </a>
        </div>
      </div>

      <!-- Gestión -->
      <div class="nav-section">
        <div class="nav-section-title">Gestión</div>
        <div class="nav-item" *ngFor="let item of menuGestion">
          <a 
            class="nav-link" 
            [routerLink]="[item.uri]"
            [class.active]="item.selected"
            (click)="selectMenuItem(item)"
          >
            <span class="icon" [innerHTML]="item.iconSvg"></span>
            <span>{{ item.name }}</span>
          </a>
        </div>
      </div>

      <!-- Configuración -->
      <div class="nav-section">
        <div class="nav-section-title">Configuración</div>
        <div class="nav-item" *ngFor="let item of menuConfig">
          <a 
            class="nav-link" 
            [routerLink]="[item.uri]"
            [class.active]="item.selected"
            (click)="selectMenuItem(item)"
          >
            <span class="icon" [innerHTML]="item.iconSvg"></span>
            <span>{{ item.name }}</span>
          </a>
        </div>
      </div>
    </nav>

    <div class="sidebar-footer">
      <div class="user-menu" (click)="toggleUserMenu()">
        <div class="user-avatar">
          {{ userInitials }}
        </div>
        <div class="user-info">
          <div class="user-name">{{ userName }}</div>
          <div class="user-role">{{ userRole }}</div>
        </div>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--gray-400);">
          <path d="m7 15 5 5 5-5"/>
          <path d="m7 9 5-5 5 5"/>
        </svg>
      </div>
      
      @if (showUserMenu) {
        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1);">
          <button class="btn btn-danger btn-block btn-sm" (click)="logout()">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
              <polyline points="16 17 21 12 16 7"/>
              <line x1="21" x2="9" y1="12" y2="12"/>
            </svg>
            Cerrar Sesión
          </button>
        </div>
      }
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Top Bar -->
    <header class="top-bar">
      <div class="page-title">
        <h1>{{ currentPageTitle }}</h1>
        <nav class="breadcrumb">
          <a routerLink="/backoffice/tablero">Inicio</a>
          <span class="separator">/</span>
          <span>{{ currentPageTitle }}</span>
        </nav>
      </div>

      <div class="top-bar-actions">
        <div class="search-box">
          <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.3-4.3"/>
          </svg>
          <input type="text" placeholder="Buscar...">
        </div>

        <button class="notification-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/>
            <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/>
          </svg>
          <span class="badge">3</span>
        </button>
      </div>
    </header>

    <!-- Page Content -->
    <div class="page-container">
      <router-outlet />
    </div>
  </main>
</div>
